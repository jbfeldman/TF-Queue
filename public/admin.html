<!DOCTYPE html>
<html>
<head>
  <title>Admin Page</title>
  <link rel="stylesheet" href="admin-style.css" type="text/css"/>
</head>
<script src="/socket.io/socket.io.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>

	//loads the queue the first time
	update();

	var Client = {};
	Client.socket = io.connect();

	//update: requests the lists of students/questions from the server,
	// and then formats them in HTML and loads them onto the page
	function update(){
		$.post("queue", function(data){
			var list = "";
			var name;
			var q;
			var id;
			data = JSON.parse(data);

			if(data.length == 0){
				$("#queue").html("<h3> Queue is empty</h3>");
			}
			else{
				//cycles through the array of students/questions, formats them in HTML,
				// including adding a button which posts "remove" the server when clicked
				// and sends the MongoDB ID of the student/question document
				for (i = 0; i < data.length; i++){
    		  		name = data[i].name;
    		  		q = data[i].quest;
    		  		id = data[i]._id;
    		  		list = list + '<form action="/remove" method="post">' + (i + 1) 
    		  		+ ". " + name + ": " + q  + "&nbsp &nbsp" + '<button type="submit" name="ID" value = "'
    		  		 + id + '">Remove</button>' + '</form> <br> <br>';
    			}
				$("#queue").html(list); //this replaces the Loading with the queue of students
			}
		});
		
	};
/*
	$(document).ready(function () {
	    $('form').on('submit', function(e) {
	      	e.preventDefault();
	      	$.post($(this).attr('action'), $(this).serialize(), function(data){
	      		
	      			
	        });
	    });
	}); 
*/
	

	//if the server tells us changes are made, reloads the queue
	Client.socket.on("change", function(){
		update();
	});


</script> 
<html>
	<h1> Welcome to the admin Page </h1>

	<fieldset id="queue">
        <p>Loading Queue...</p>

</html>
